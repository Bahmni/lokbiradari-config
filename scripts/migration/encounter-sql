SELECT "PTSRNO" as "Registration Number",
	"PTNAME" as "Patient.Name",
	"AGEyears" as "Patient.AGE",
	"SEX" as "Patient.Gender",
	"VILLAGENAME" as "Patient.Village",
	"ACTIONDATE"::timestamp::date as "Repeat.1.EncounterDate",
	"DISEASENAME1" as "Repeat.1.Diagnosis.diagnosis1",
	"DISEASENAME2" as "Repeat.1.Diagnosis.diagnosis2",
	"DISEASENAME3" as "Repeat.1.Diagnosis.diagnosis3",
	"PTACTION" as "Repeat.1.Drugorder.Imported"
	FROM ptmaster where "IPDATE" is not NULL or 
	"DISCHARGEDATE" is not NULL;

SELECT "PTSRNO" as "Registration Number",
	"PTNAME" as "Patient.Name",
	"AGEyears" as "Patient.AGE",
	"SEX" as "Patient.Gender",
	"VILLAGENAME" as "Patient.Village",
	"ACTIONDATE"::timestamp::date as "Repeat.1.EncounterDate",
	"DISEASENAME1" as "Repeat.1.Diagnosis.diagnosis1",
	"DISEASENAME2" as "Repeat.1.Diagnosis.diagnosis2",
	"DISEASENAME3" as "Repeat.1.Diagnosis.diagnosis3",
	"PTACTION" as "Repeat.1.Drugorder.Imported"
	FROM ptmaster where "IPDATE" is NULL and 
	"DISCHARGEDATE" is NULL;

SELECT DISTINCT on ("PTSRNO") * FROM ptmaster 
	where "IPDATE" is not NULL and "DISCHARGEDATE" is NULL;

SELECT * FROM ptmaster 
	where "IPDATE" is not NULL and "DISCHARGEDATE" is NULL;

SELECT "PTSRNO","PTNAME",COUNT("PTSRNO") AS NumOccurrences FROM ptmaster 
	where "IPDATE" is not NULL and 
	"DISCHARGEDATE" is NULL 
	GROUP BY "PTSRNO","PTNAME" HAVING (COUNT("PTSRNO")> 1);

SELECT "PTSRNO","PTNAME",COUNT("PTSRNO") AS NumOccurrences 
	FROM ptmaster where "IPDATE" is NULL and 
	"DISCHARGEDATE" is NULL 
	GROUP BY "PTSRNO","PTNAME" order by NumOccurrences;

select "PTSRNO","PTNAME",COUNT("PTSRNO") AS NumOccurrences 
	FROM ptmaster where "IPDATE" is not NULL and 
	"DISCHARGEDATE" is not NULL and 
	"IPDATE" > "DISCHARGEDATE" 
	group by "PTSRNO","PTNAME";
